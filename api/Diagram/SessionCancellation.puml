@startuml
<style>
  partition {
    LineColor Black
    LineThickness 2.5
  }
</style>

start
title request Session Cancellation

note
Entry Requirement
    - record hasn't expired yet
    - session status = 1;
**record will expired 24H before class**
end note

:Submit a Form;
: OLD_Version >> session -> cancelled = True
 NEW_Version >> session status -> cancelled;
partition Sub Party {
    repeat :Sub Party Process;
        label A
        if (Record has Entry Requirement) then (Yes)
            :wait for a teacher To accept;
            partition Sub Request {
                :Submit a Sub Form;
                if (Accepted) then (Yes)
                    :Form status = Accepted;
                    split
                      :Current session
                      status -> deleted;
                    split again
                        :New session
                        is-sub = True
                        session status = Accepted;
                    end split
                else (No)
                endif
            }
        else (No)
            stop
        endif
    repeat while (sub request rejected?) is (Yes) -[#blue]->
}
stop

@enduml
